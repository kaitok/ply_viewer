<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Graphics</title>
    <style>
      body { 
        margin: 0;
        height: 100%;
        background: #000;
      }
      .head {
        height: 20px;
        color: #fff;
        padding: 20px 0 0 10px;
      }
		</style>
    <script src="js/three.js"></script>
    <script src="js/PLYLoader.js"></script>
    <script src="js/OrbitControls.js"></script>
    <script>
    window.addEventListener( "DOMContentLoaded", init);  
    window.addEventListener('resize', onResize, false);
    var renderer, camera, group;
    function init() {
      const width = window.innerWidth;
      const height = window.innerHeight;
      renderer = new THREE.WebGLRenderer({
        canvas: document.querySelector("#canvas")
      });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(width, height);

      const scene = new THREE.Scene();
      var fov = 90 // 視野角：0～90
      var aspect = canvas.clientWidth / canvas.clientHeight; // 縦横比
      var near = 1; // 視体積手前までの距離
      var far = 100; // 視体積奥までの距離
      camera = new THREE.PerspectiveCamera(fov, aspect, near, far)
      camera.position.set(0, 0, 14);

      var controls = new THREE.OrbitControls( camera, renderer.domElement );
      update();

      const plyLoader = new THREE.PLYLoader();
      const plyMaterial = new THREE.PointsMaterial({
        color: 0x00ff00,
        size: 0.05
      });

      plyLoader.load('./data/sample.ply', (geometry) => {
        group = new THREE.Points(geometry, plyMaterial);
        group.sortParticles = true;
        scene.add(group);
        renderer.render( scene, camera );
      });

      tick()

      function update() {
        renderer.render(scene, camera);
        requestAnimationFrame(update);
      }

      function tick() {
        requestAnimationFrame(tick);
        group.rotation.y -= 0.0005;
      }
    }

    function onResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }
		</script>
  </head>
  <body>

    <div class="head">
      Graphics
    </div>
    <canvas id="canvas"></canvas>

  </body>
</html>